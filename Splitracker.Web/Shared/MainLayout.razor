@inherits LayoutComponentBase

@code {
    bool isDarkMode;
    MudThemeProvider? mudThemeProvider;
    
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            isDarkMode = await mudThemeProvider!.GetSystemPreference();
            StateHasChanged();
        }
    }
}

<PageTitle>Splitracker.Web</PageTitle>

<MudThemeProvider @ref="mudThemeProvider" @bind-IsDarkMode="isDarkMode" />
<MudDialogProvider/>
<MudSnackbarProvider/>

<MudLayout Class="@CssClass.Rendered(("dark", isDarkMode))">
    <MudAppBar>
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="@Color.Inherit" Edge="@Edge.Start" OnClick="@drawerToggle"/>
        <MudText
            Typo="Typo.h5"
            Class="ml-3">
            Splitracker
        </MudText>
        <MudSpacer/>
        <SectionOutlet
            Name="top"/>
        <LoginDisplay/>
        <MudToggleIconButton
            Icon="@Icons.Material.Filled.LightMode"
            ToggledIcon="@Icons.Material.Filled.DarkMode"
            @bind-Toggled="isDarkMode"/>
    </MudAppBar>
    <MudDrawer @bind-Open="drawerOpen" ClipMode="@DrawerClipMode.Always" >
        <NavMenu/>
    </MudDrawer>
    <MudMainContent>
        <MudContainer Class="mb-16 pt-2">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {

    bool drawerOpen;
    void drawerToggle() => drawerOpen = !drawerOpen;

}
